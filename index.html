<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tap Leaderboard</title>
  <style>
    * { box-sizing: border-box; }
    body { margin: 0; font-family: system-ui, Arial; height: 100vh; background:#fafafa; color:#111; transition: background .25s, color .25s; }

    header{
      position: fixed; top: 0; left: 0; right: 0;
      display: flex; align-items: center; justify-content: space-between;
      padding: 12px 16px; background: #fff; border-bottom: 1px solid #eee;
      z-index: 10;
      transition: background .25s, border-color .25s;
    }
    .brand{ font-weight: 800; }
    nav{ display:flex; gap:12px; align-items:center; }
    nav a{ text-decoration:none; color:#111; padding:6px 10px; border-radius:10px; }
    nav a:hover{ background:#f3f3f3; }
    .pill{ font-size: 12px; opacity: .7; }

    /* ---------- Theme Switch ---------- */
    .themeSwitch{
      position: relative;
      width: 46px;
      height: 24px;
      display: inline-block;
      margin-left: 12px;
    }
    .themeSwitch input{ display:none; }

    .themeSwitch .slider{
      position: absolute;
      cursor: pointer;
      inset: 0;
      background: #ddd;
      border-radius: 999px;
      transition: .25s;
    }
    .themeSwitch .slider::before{
      content:"";
      position:absolute;
      height: 18px;
      width: 18px;
      left: 3px;
      top: 3px;
      background: white;
      border-radius: 50%;
      transition: .25s;
    }

    .themeSwitch input:checked + .slider{
      background: #111;
    }
    .themeSwitch input:checked + .slider::before{
      transform: translateX(22px);
    }

    main{
      height: 100vh;
      display: grid;
      place-items: center;
      padding-top: 54px;
      user-select: none;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }
    main.blocked{ cursor: not-allowed; }

    .card{
      position: relative;
      text-align:center;
      padding: 24px;
      border: 1px solid #eee;
      border-radius: 18px;
      box-shadow: 0 10px 30px rgba(0,0,0,.07);
      max-width: 520px;
      width: calc(100% - 48px);
      background: #fff;
      z-index: 5;
      transition: background .25s, border-color .25s, box-shadow .25s;
    }
    .name{ font-size: 22px; font-weight: 800; margin-top: 4px; }

    .countWrap{
      position: relative;
      margin: 14px auto 8px;
      width: 280px;
      height: 160px;
      display: grid;
      place-items: center;
    }
    .count{
      font-size: 72px;
      font-weight: 950;
      margin: 0;
      line-height: 1;
    }
    .hint { opacity:.7; margin-top: 10px; }

    .warning{
      position: fixed;
      top: 60px;
      left: 50%;
      transform: translateX(-50%);
      font-weight: 950;
      font-size: 34px;
      letter-spacing: 1px;
      padding: 10px 18px;
      border-radius: 999px;
      color: #111;
      background: #ffe66b;
      border: 2px solid #111;
      box-shadow: 0 10px 26px rgba(0,0,0,.16);
      z-index: 50;
      display: none;
    }
    .warning.show{ display:block; }

    .duckLayer{
      position: absolute;
      inset: 0;
      pointer-events: none;
      z-index: 25;
    }

    .duck{
      position: absolute;
      pointer-events: auto;
      cursor: pointer;
      user-select: none;
    }

    .duck .body{
      display: inline-block;
      font-size: 44px;
      filter: drop-shadow(0 10px 14px rgba(0,0,0,.15));
      line-height: 1;
      transform-origin: 50% 80%;
    }

    .hug1{ top: 18px; left: 8px; transform: rotate(-10deg); }
    .hug2{ top: 10px; right: 10px; transform: rotate(12deg); }
    .hug3{ bottom: 10px; left: 18px; transform: rotate(10deg); }

    .walking{ animation: walkIn 950ms ease-out forwards; }
    @keyframes walkIn{
      0%   { transform: translate(var(--fromX), var(--fromY)) scale(.95); opacity: .8; }
      100% { transform: translate(0,0) scale(1); opacity: 1; }
    }

    .toast{
      position: fixed; bottom: 14px; left: 50%; transform: translateX(-50%);
      background: #111; color:#fff; padding:10px 14px; border-radius: 999px;
      font-size: 13px; opacity: 0; pointer-events:none; transition: opacity .2s;
      z-index: 60;
    }
    .toast.show{ opacity: 1; }

    /* Cage */
    .cage{
      position: fixed;
      left: 14px;
      bottom: 14px;
      width: 190px;
      height: 120px;
      background: rgba(255,255,255,.96);
      border: 2px solid #111;
      border-radius: 16px;
      box-shadow: 0 12px 26px rgba(0,0,0,.12);
      z-index: 70;
      display: grid;
      grid-template-rows: auto 1fr;
      overflow: hidden;
      pointer-events: none;
      transition: background .25s, border-color .25s;
    }
    .cageTop{
      display:flex;
      align-items:center;
      justify-content: space-between;
      padding: 10px;
      border-bottom: 1px solid rgba(0,0,0,.10);
      font-weight: 900;
      font-size: 13px;
    }
    .cageCount{
      font-weight: 950;
      font-size: 12px;
      padding: 4px 8px;
      border-radius: 999px;
      background: #f3f3f3;
      border: 1px solid #e6e6e6;
    }
    .cageBody{
      position: relative;
      display:grid;
      place-items:center;
      font-size: 12px;
    }
    .cageBars{
      position:absolute;
      inset:0;
      background:
        repeating-linear-gradient(
          90deg,
          rgba(0,0,0,.22) 0px,
          rgba(0,0,0,.22) 2px,
          rgba(0,0,0,0) 2px,
          rgba(0,0,0,0) 14px
        );
      opacity:.35;
      pointer-events:none;
    }

    .toCage{
      position: fixed !important;
      transition: left 520ms ease, top 520ms ease, transform 520ms ease, opacity 520ms ease;
      z-index: 80 !important;
      pointer-events: none !important;
    }

    /* ---------- Dark Mode ---------- */
    body.dark{
      background: #0f1115;
      color: #eaeaf0;
    }
    body.dark header{
      background: #141722;
      border-bottom-color: #222;
    }
    body.dark nav a{ color: #eaeaf0; }
    body.dark nav a:hover{ background:#1d2133; }
    body.dark .card{
      background: #141722;
      border-color: #222;
      box-shadow: 0 10px 30px rgba(0,0,0,.6);
    }
    body.dark .cage{
      background:#141722;
      border-color:#333;
    }
    body.dark .toast{
      background:#eee;
      color:#111;
    }
  </style>
</head>
<body>

  <header>
    <div class="brand">Tap Leaderboard</div>
    <nav>
      <a href="#">Home</a>
      <a href="#">Leaderboard</a>
      <span class="pill" id="navUser"></span>

      <!-- Theme toggle -->
      <label class="themeSwitch">
        <input type="checkbox" id="themeToggle">
        <span class="slider"></span>
      </label>
    </nav>
  </header>

  <div class="warning" id="warning">DUCKS INVADING!!</div>

  <div class="cage" id="cage">
    <div class="cageTop">
      <span>Duck Cage</span>
      <span class="cageCount" id="cageCount">0</span>
    </div>
    <div class="cageBody">
      <div class="cageBars"></div>
      <div>Captured ducks fly here ü¶Ü‚û°Ô∏è</div>
    </div>
  </div>

  <main id="tapArea">
    <div class="duckLayer" id="duckLayer"></div>

    <div class="card">
      <div class="pill" id="statusLine">Tap anywhere!</div>
      <div class="name" id="displayName">Guest</div>
      <div class="countWrap">
        <div class="count" id="count">0</div>
      </div>
      <div class="hint">Tap/click anywhere to add +1</div>
    </div>
  </main>

  <div class="toast" id="toast"></div>

  <script>
    const countEl = document.getElementById("count");
    const tapArea = document.getElementById("tapArea");
    const duckLayer = document.getElementById("duckLayer");
    const cage = document.getElementById("cage");
    const cageCountEl = document.getElementById("cageCount");
    const toast = document.getElementById("toast");

    let count = 0;
    let caged = 0;

    function showToast(msg){
      toast.textContent = msg;
      toast.classList.add("show");
      setTimeout(() => toast.classList.remove("show"), 900);
    }

    function spawnDuck(){
      const duck = document.createElement("div");
      duck.className = "duck walking hug1";
      duck.innerHTML = `<span class="body">ü¶Ü</span>`;
      duck.style.setProperty("--fromX", "-200px");
      duck.style.setProperty("--fromY", "-100px");
      duck.style.left = "100px";
      duck.style.top = "100px";
      tapArea.appendChild(duck);

      duck.addEventListener("pointerdown", (e) => {
        e.stopPropagation();

        const r = duck.getBoundingClientRect();
        const cr = cage.getBoundingClientRect();

        duck.classList.add("toCage");
        duck.style.left = r.left + "px";
        duck.style.top = r.top + "px";
        duck.style.transform = "scale(1)";
        duck.style.opacity = "1";

        void duck.offsetWidth;

        duck.style.left = (cr.left + cr.width * 0.6) + "px";
        duck.style.top = (cr.top + cr.height * 0.6) + "px";
        duck.style.transform = "scale(0.2)";
        duck.style.opacity = "0.1";

        setTimeout(() => {
          duck.remove();
          caged++;
          cageCountEl.textContent = caged;
        }, 550);
      });
    }

    tapArea.addEventListener("pointerdown", () => {
      count++;
      countEl.textContent = count;
      if (count % 10 === 0){
        spawnDuck();
        showToast("A duck appeared!");
      }
    });

    // --------- Theme toggle ----------
    const themeToggle = document.getElementById("themeToggle");
    const savedTheme = localStorage.getItem("theme");

    if (savedTheme === "dark"){
      document.body.classList.add("dark");
      themeToggle.checked = true;
    }

    themeToggle.addEventListener("change", () => {
      if (themeToggle.checked){
        document.body.classList.add("dark");
        localStorage.setItem("theme", "dark");
      } else {
        document.body.classList.remove("dark");
        localStorage.setItem("theme", "light");
      }
    });
  </script>

</body>
</html>
